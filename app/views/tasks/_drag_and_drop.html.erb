<script>
  // ドラッグ&ドロップ機能 (sortable.js)

$(document).ready(function(){
  function dragEnd(evt) {
    var item = evt.item;
    var item_id = $(item).find('.item').attr('value')
    var matrix_id = evt.to.id

    $.ajax({
      url: "tasks/" + item_id + "/change_matrix",
      type: "patch",
      data: { matrix_id }
    });
  }

  var el = document.getElementById("sortable_task_1")
  var sortable = Sortable.create(el, {
    draggable: '.draggable-item',
    group: {
      name: "shares",
    },
    animation: 250,
    onAdd: function(evt) {
      dragEnd(evt)
    }
  })

  var el = document.getElementById("sortable_task_0")
  var sortable = Sortable.create(el, {
    draggable: '.draggable-item',
    group: {
      name: "shares",
    },
    animation: 250,
    onAdd: function(evt) {
      dragEnd(evt)
    }
  })

  var el = document.getElementById("sortable_task_3")
  var sortable = Sortable.create(el, {
    draggable: '.draggable-item',
    group: {
      name: "shares",
    },
    animation: 250,
    onAdd: function(evt) {
      dragEnd(evt)
    }
  })

  var el = document.getElementById("sortable_task_2")
  var sortable = Sortable.create(el, {
    draggable: '.draggable-item',
    group: {
      name: "shares",
    },
    animation: 250,
    onAdd: function(evt) {
      dragEnd(evt)
    }
  })
});

</script>